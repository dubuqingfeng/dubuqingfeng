---
title: 基于 Arduino 的解魔方机器人组装调试
date: 2015-03-24 14:23
updated: 2015-03-24 22:12
tags: 
  - 电子设计
  - 解魔方机器人
  - 技术
description: 记录从“能动”到“稳定能跑”的组装与调试过程：串口电平、供电共地、舵机控制板、蓝牙链路，以及单元测试到整机联调的检查清单。
excerpt: 本文在机械与电路部分的初步设计之下，进行一些主控板与硬件器件的辨析、连接与调试。
categories: 电子设计
permalink: 201503-Rubik's-Cube-Robot-Zhuzhuangtiaoshi.html
author: admin, codex
toc: true
---

# 0x00 目标与调试顺序
把“设计”变成“可运行的机器”。建议按下面顺序联调，**每一步都能独立验证**，不要一上来就整机联调。

1. 电源与共地（先保证供电不掉压、不会把 MCU 拉挂）
2. 串口链路（PC/Android -> 蓝牙/USB-串口 -> MCU/舵机控制板）
3. 舵机单元测试（单舵机 -> 多舵机）
4. 机械装配与限位（推进、夹持、旋转的重复精度）
5. 整机联调（按动作序列执行，遇到异常可停机松手）

![解魔方机器人联调接线示意](/img/blog/rubiks-cube-robot/wiring-debug.svg)

<!-- truncate -->

# 0x01 主控板（以 LM3S615 为例）
LM3S615 属于 TI 的 LM3S 系列（ARM Cortex-M3），调试通常用 20 针 JTAG + J-LINK。

建议优先确认这三件事：

- UART：能稳定收发（包括波特率、数据位、校验位）
- GPIO：基本输入输出正常（LED/按键/限位开关）
- PWM/定时器：能提供稳定的节拍（用于舵机控制或动作时序）

资料获取方式：优先使用芯片/开发板厂商提供的 datasheet、user guide、原理图（这类资料一般都能搜到，但本文不贴不确定的下载链接）。

# 0x02 串口电平：TTL 与 RS-232（容易踩坑）
常见三种“串口”其实电平不同：

- TTL 3.3V（MCU 常见）
- TTL 5V（Arduino/部分模块）
- RS-232（PC 老接口，电平是正负电压）

注意事项：

- **RS-232 不能直接接 MCU UART**，必须用 MAX3232 之类做电平转换
- 蓝牙模块（HC-05/HM-10）通常是 TTL 电平，先确认是 3.3V 还是 5V
- TX/RX 要交叉接（TX -> RX，RX -> TX）
- GND 必须共地，否则“偶尔能通、偶尔乱码”特别常见

# 0x03 GPIO / 限位（让系统“可控”）
如果机械结构有推进/夹持，建议至少留两类输入：

- 推进到位限位（前/后）
- 夹爪开合到位限位（开/合）

这样能实现：

- 上电自检与归零（homing）
- 超时保护（动作没到位就停）
- 重复精度提升（每次都对齐同一个物理参考点）

# 0x04 舵机控制板（24 路 PWM）
用的是 Arduino 24 路舵机控制板 V4.21（串口控制 + 多路 PWM 输出）。

建议先做两件事：

1. **只接一只舵机**（不要一上来接满）
2. **只用 PC 直连控制板**（USB-串口），先排除蓝牙/MCU 干扰

接线要点：

- 舵机电源（5-6V，大电流）和逻辑电源（3.3/5V）要区分
- 舵机电源要富余，负载变化会瞬间拉低电压
- 控制板与 MCU/蓝牙/USB-串口必须**共地**

# 0x05 UART 链路（PC/Android -> 蓝牙/USB-串口 -> 控制板）
建议准备一个“可复现”的最小链路：

- 先用 PC 串口助手直连舵机控制板（确认控制板协议与波特率）
- 再接蓝牙模块（把蓝牙当“无线串口”）
- 最后引入 MCU（让 MCU 转发或生成动作序列）

常见故障排查：

- 乱码：波特率不一致 / 电平不匹配 / 没共地
- 丢包：蓝牙不稳定 / 数据太快 / 没有 ACK/重发策略

# 0x06 舵机单元测试（从“能转”到“转得准”）
测试目标不是“转一下”，而是：

- 重复性：同一命令 100 次，最终角度偏差可接受
- 回差：正反切换后是否有明显误差（齿隙/机械回差）
- 负载：夹着魔方时是否掉速、抖动或卡死

建议记录每个舵机：

- 中位点（例如 90 度）对应的 PWM 值
- 端点（避免顶死）对应的安全范围

# 0x07 机械装配（夹爪 / 导轨 / 主舵机）
机械部分建议按“先松后紧”的方式装配：

- 先让导轨/滑轮在无负载下顺滑往复
- 再装夹爪并贴缓冲垫（硅胶/橡胶），防打滑与防刮
- 最后再把主舵机的旋转动作加入，并做限位

经验：如果发现“空载很顺、夹上魔方就卡”，多半是对齐问题（轴线不共线/导轨不平行/夹爪偏心）。

# 0x08 蓝牙与舵机控制板/MCU 联调
蓝牙模块供电和电平要先确认：

- HC-05 常见是 5V 供电，但 RX 可能仍然是 3.3V 逻辑（不同板子不同）
- HM-10 多为 3.3V

联调建议：

- 蓝牙先配成透明串口模式（模块默认就行）
- 上位机每发一条指令，等待下位机回 ACK（避免堆积）
- 加一个“急停指令”：立刻松夹爪、停止旋转、退回到安全位置

# 0x09 整机联调检查清单（建议贴在工位上）
- 电源：舵机电源电流足够；逻辑电源稳定；共地
- 串口：波特率一致；电平正确；TX/RX 交叉
- 舵机：端点不顶死；中位校准完成
- 机械：导轨顺滑；夹爪不刮方块；限位有效
- 软件：动作序列可中断；异常能松手；日志可追踪（至少打印当前步骤）

# 0x0A 参考
- 《ARM体系结构与外设接口实战开发》（北京航空航天大学出版社）

"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[3288],{92312:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Wiki/programming/nodejs/io/streams","title":"streams","description":"\u6d41\u4e0e\u80cc\u538b\uff08Streams\uff09","source":"@site/docs/Wiki/programming/nodejs/io/streams.md","sourceDirName":"Wiki/programming/nodejs/io","slug":"/Wiki/programming/nodejs/io/streams","permalink":"/docs/Wiki/programming/nodejs/io/streams","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"fs","permalink":"/docs/Wiki/programming/nodejs/io/fs"},"next":{"title":"esm-cjs","permalink":"/docs/Wiki/programming/nodejs/modules/esm-cjs"}}');var t=r(74848),s=r(28453);const a={},o=void 0,c={},l=[{value:"\u6d41\u4e0e\u80cc\u538b\uff08Streams\uff09",id:"\u6d41\u4e0e\u80cc\u538bstreams",level:3},{value:"\u8981\u70b9",id:"\u8981\u70b9",level:4},{value:"\u793a\u4f8b\uff1a\u6587\u4ef6\u538b\u7f29\u7ba1\u9053",id:"\u793a\u4f8b\u6587\u4ef6\u538b\u7f29\u7ba1\u9053",level:4},{value:"\u793a\u4f8b\uff1a\u624b\u52a8\u5904\u7406\u80cc\u538b",id:"\u793a\u4f8b\u624b\u52a8\u5904\u7406\u80cc\u538b",level:4},{value:"\u793a\u4f8b\uff1aAsync iterator \u8bfb\u53d6",id:"\u793a\u4f8basync-iterator-\u8bfb\u53d6",level:4}];function d(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"\u6d41\u4e0e\u80cc\u538bstreams",children:"\u6d41\u4e0e\u80cc\u538b\uff08Streams\uff09"}),"\n",(0,t.jsx)(n.p,{children:"Node \u7684 Stream \u62bd\u8c61\u652f\u6301\u9ad8\u6548 I/O \u4e0e\u80cc\u538b\u63a7\u5236\uff0c\u7c7b\u578b\u5305\u542b Readable/Writable/Duplex/Transform\u3002"}),"\n",(0,t.jsx)(n.h4,{id:"\u8981\u70b9",children:"\u8981\u70b9"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u6a21\u5f0f\uff1aflowing \u4e0e paused\uff1b",(0,t.jsx)(n.code,{children:"pipeline"})," \u7ec4\u5408\u4e0e\u9519\u8bef\u4f20\u64ad\uff1b"]}),"\n",(0,t.jsxs)(n.li,{children:["\u80cc\u538b\uff1a",(0,t.jsx)(n.code,{children:"write()"})," \u8fd4\u56de\u503c\u4e0e ",(0,t.jsx)(n.code,{children:"drain"})," \u4e8b\u4ef6\uff1b"]}),"\n",(0,t.jsx)(n.li,{children:"Promise \u5316\u4e0e async iterator\uff1b"}),"\n",(0,t.jsxs)(n.li,{children:["\u53c2\u8003\uff1a\u66f4\u7cfb\u7edf\u7684\u5185\u5bb9\u89c1 JavaScript \u7ae0\u8282\u7684",(0,t.jsx)(n.a,{href:"/docs/Wiki/programming/javascript/runtime/streams",children:"Node Streams\uff08\u6d41\uff09"}),"\u3002"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"\u793a\u4f8b\u6587\u4ef6\u538b\u7f29\u7ba1\u9053",children:"\u793a\u4f8b\uff1a\u6587\u4ef6\u538b\u7f29\u7ba1\u9053"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { createReadStream, createWriteStream } from 'node:fs';\nimport { pipeline } from 'node:stream/promises';\nimport zlib from 'node:zlib';\n\nawait pipeline(\n  createReadStream('input.txt'),\n  zlib.createGzip(),\n  createWriteStream('output.txt.gz')\n);\n"})}),"\n",(0,t.jsx)(n.h4,{id:"\u793a\u4f8b\u624b\u52a8\u5904\u7406\u80cc\u538b",children:"\u793a\u4f8b\uff1a\u624b\u52a8\u5904\u7406\u80cc\u538b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { once } from 'node:events';\n\nasync function writeMany(writable, chunks) {\n  for (const chunk of chunks) {\n    if (!writable.write(chunk)) {\n      await once(writable, 'drain'); // \u80cc\u538b\u91ca\u653e\u540e\u7ee7\u7eed\n    }\n  }\n  writable.end();\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"\u793a\u4f8basync-iterator-\u8bfb\u53d6",children:"\u793a\u4f8b\uff1aAsync iterator \u8bfb\u53d6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"for await (const buf of createReadStream('big.bin')) {\n  // \u9010\u5757\u5904\u7406\n}\n"})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var i=r(96540);const t={},s=i.createContext(t);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);
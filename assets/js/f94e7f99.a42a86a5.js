"use strict";(globalThis.webpackChunkdubuqingfeng=globalThis.webpackChunkdubuqingfeng||[]).push([[59492],{28453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>o});var t=n(96540);const s={},i=t.createContext(s);function a(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:r},e.children)}},31263:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Wiki/programming/dart/server-shelf","title":"Shelf\uff08\u670d\u52a1\u7aef\uff09","description":"\u4f7f\u7528 shelf \u5feb\u901f\u6784\u5efa Dart \u670d\u52a1\u7aef HTTP \u5e94\u7528\u3002","source":"@site/docs/Wiki/programming/dart/server-shelf.md","sourceDirName":"Wiki/programming/dart","slug":"/Wiki/programming/dart/server-shelf","permalink":"/docs/Wiki/programming/dart/server-shelf","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Shelf\uff08\u670d\u52a1\u7aef\uff09"},"sidebar":"tutorialSidebar","previous":{"title":"\u6027\u80fd\u4e0e\u6784\u5efa\u4f18\u5316","permalink":"/docs/Wiki/programming/dart/performance"},"next":{"title":"\u6d4b\u8bd5\u4e0e\u8986\u76d6\u7387","permalink":"/docs/Wiki/programming/dart/testing"}}');var s=n(74848),i=n(28453);const a={title:"Shelf\uff08\u670d\u52a1\u7aef\uff09"},o=void 0,l={},d=[{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u8def\u7531\u4e0e\u4e2d\u95f4\u4ef6\uff08shelf_router\uff09",id:"\u8def\u7531\u4e0e\u4e2d\u95f4\u4ef6shelf_router",level:2},{value:"CORS/\u9519\u8bef\u5904\u7406",id:"cors\u9519\u8bef\u5904\u7406",level:2}];function c(e){const r={code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"shelf"})," \u5feb\u901f\u6784\u5efa Dart \u670d\u52a1\u7aef HTTP \u5e94\u7528\u3002"]}),"\n",(0,s.jsx)(r.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-dart",children:"import 'dart:io';\nimport 'package:shelf/shelf.dart';\nimport 'package:shelf/shelf_io.dart' as io;\n\nvoid main() async {\n  final handler = const Pipeline()\n      .addMiddleware(logRequests())\n      .addHandler((req) => Response.ok('hello'));\n  final server = await io.serve(handler, InternetAddress.anyIPv4, 8080);\n  print('Serving at http://${server.address.host}:${server.port}');\n}\n"})}),"\n",(0,s.jsx)(r.h2,{id:"\u8def\u7531\u4e0e\u4e2d\u95f4\u4ef6shelf_router",children:"\u8def\u7531\u4e0e\u4e2d\u95f4\u4ef6\uff08shelf_router\uff09"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-dart",children:"import 'package:shelf_router/shelf_router.dart';\n\nfinal app = Router()\n  ..get('/health', (Request _) => Response.ok('ok'))\n  ..get('/users/<id|[0-9]+>', (Request req, String id) => Response.ok('user $id'));\n"})}),"\n",(0,s.jsx)(r.h2,{id:"cors\u9519\u8bef\u5904\u7406",children:"CORS/\u9519\u8bef\u5904\u7406"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-dart",children:"Response Function(Handler) cors() => (inner) => (req) async {\n  final res = await inner(req);\n  return res.change(headers: {\n    ...res.headers,\n    'access-control-allow-origin': '*',\n  });\n};\n"})})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);
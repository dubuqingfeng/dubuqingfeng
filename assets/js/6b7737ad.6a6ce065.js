"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[5628],{37426:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Wiki/programming/nodejs/modules/esm-cjs","title":"esm-cjs","description":"\u6a21\u5757\u7cfb\u7edf\uff1aESM \u4e0e CommonJS","source":"@site/docs/Wiki/programming/nodejs/modules/esm-cjs.md","sourceDirName":"Wiki/programming/nodejs/modules","slug":"/Wiki/programming/nodejs/modules/esm-cjs","permalink":"/docs/Wiki/programming/nodejs/modules/esm-cjs","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"streams","permalink":"/docs/Wiki/programming/nodejs/io/streams"},"next":{"title":"observability","permalink":"/docs/Wiki/programming/nodejs/ops/observability"}}');var o=s(74848),r=s(28453);const c={},d=void 0,t={},l=[{value:"\u6a21\u5757\u7cfb\u7edf\uff1aESM \u4e0e CommonJS",id:"\u6a21\u5757\u7cfb\u7edfesm-\u4e0e-commonjs",level:3},{value:"\u8981\u70b9",id:"\u8981\u70b9",level:4},{value:"\u793a\u4f8b\uff1a\u53cc\u5305\u5bfc\u51fa\uff08CJS/ESM\uff09",id:"\u793a\u4f8b\u53cc\u5305\u5bfc\u51facjsesm",level:4}];function m(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h3,{id:"\u6a21\u5757\u7cfb\u7edfesm-\u4e0e-commonjs",children:"\u6a21\u5757\u7cfb\u7edf\uff1aESM \u4e0e CommonJS"}),"\n",(0,o.jsxs)(n.p,{children:["Node \u540c\u65f6\u652f\u6301 CJS\uff08",(0,o.jsx)(n.code,{children:"require/module.exports"}),"\uff09\u4e0e ESM\uff08",(0,o.jsx)(n.code,{children:"import/export"}),"\uff09\uff0c\u4e24\u8005\u6709\u5dee\u5f02\u4e0e\u4e92\u64cd\u4f5c\u8fb9\u754c\u3002"]}),"\n",(0,o.jsx)(n.h4,{id:"\u8981\u70b9",children:"\u8981\u70b9"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u8bc6\u522b\uff1a",(0,o.jsx)(n.code,{children:"type: module"}),"\u3001",(0,o.jsx)(n.code,{children:".mjs"}),"/",(0,o.jsx)(n.code,{children:".cjs"}),"\u3001",(0,o.jsx)(n.code,{children:"package.json#exports"}),"\uff1b"]}),"\n",(0,o.jsxs)(n.li,{children:["\u4e92\u64cd\u4f5c\uff1a",(0,o.jsx)(n.code,{children:"import()"})," \u52a8\u6001\u52a0\u8f7d CJS\u3001",(0,o.jsx)(n.code,{children:"createRequire"})," \u5728 ESM \u4e2d\u4f7f\u7528 CJS\uff1b"]}),"\n",(0,o.jsx)(n.li,{children:"\u8def\u5f84\u4e0e\u89e3\u6790\uff1aURL vs \u76f8\u5bf9\u8def\u5f84\u3001\u88f8\u6a21\u5757\u89e3\u6790\u7b56\u7565\uff1b"}),"\n",(0,o.jsx)(n.li,{children:"\u9876\u5c42 await\uff1a\u4ec5 ESM \u652f\u6301\uff1b"}),"\n",(0,o.jsx)(n.li,{children:"Tree Shaking \u4e0e\u6253\u5305\u5668\uff1aESM \u53cb\u597d\uff0c\u6ce8\u610f\u8fd0\u884c\u65f6\u5dee\u5f02\u3002"}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"\u793a\u4f8b\u53cc\u5305\u5bfc\u51facjsesm",children:"\u793a\u4f8b\uff1a\u53cc\u5305\u5bfc\u51fa\uff08CJS/ESM\uff09"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"package.json"}),"\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "name": "awesome-pkg",\n  "type": "module",\n  "exports": {\n    ".": {\n      "import": "./dist/index.mjs",\n      "require": "./dist/index.cjs",\n      "types": "./dist/index.d.ts"\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u5728 ESM \u4e2d\u4f7f\u7528 CJS\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// index.mjs\nimport { createRequire } from 'node:module';\nconst require = createRequire(import.meta.url);\nconst cjsOnly = require('some-cjs-lib');\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5728 CJS \u4e2d\u52a8\u6001\u5bfc\u5165 ESM\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// index.cjs\nasync function load() {\n  const esm = await import('some-esm-lib');\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Monorepo \u5efa\u8bae\uff1a\u4f7f\u7528 workspace + ",(0,o.jsx)(n.code,{children:"exports"})," \u9650\u5236\u79c1\u6709\u8def\u5f84\uff1b\u7edf\u4e00 TS \u8def\u5f84\u522b\u540d\u4e0e\u6253\u5305/\u6d4b\u8bd5\u5de5\u5177\u7684\u89e3\u6790\u7b56\u7565\u3002"]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(96540);const o={},r=i.createContext(o);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);
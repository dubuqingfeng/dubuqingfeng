"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[8918],{50456:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>k,frontMatter:()=>c,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"Wiki/devops/jenkins/docker","title":"docker","description":"build:","source":"@site/docs/Wiki/devops/jenkins/docker.md","sourceDirName":"Wiki/devops/jenkins","slug":"/Wiki/devops/jenkins/docker","permalink":"/docs/Wiki/devops/jenkins/docker","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"transaction","permalink":"/docs/Wiki/blockchain/solana/transaction"},"next":{"title":"kubernetes","permalink":"/docs/Wiki/devops/kubernetes/"}}');var r=t(74848),s=t(28453);const c={},i=void 0,d={},a=[];function p(n){const e={code:"code",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"version: '3'\nservices:                                      # \u96c6\u5408\n  docker_jenkins:\n    container_name: jenkins\n    user: root\n    image: jenkins/jenkins:lts                 # \u6307\u5b9a\u670d\u52a1\u6240\u4f7f\u7528\u7684\u955c\u50cf \u5728\u8fd9\u91cc\u6211\u9009\u62e9\u4e86 LTS (\u957f\u671f\u652f\u6301)\n    container_name: jenkins                    # \u5bb9\u5668\u540d\u79f0\n    ports:                                     # \u5bf9\u5916\u66b4\u9732\u7684\u7aef\u53e3\u5b9a\u4e49\n      - 8882:8080                              # \u8bbf\u95eeJenkins\u670d\u52a1\u7aef\u53e3\n      - 50000:50000\n    volumes:                                   # \u5377\u6302\u8f7d\u8def\u5f84\n      - /data/jenkins/data:/var/jenkins_home  # \u8fd9\u662f\u6211\u4eec\u4e00\u5f00\u59cb\u521b\u5efa\u7684\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u5185\u7684jenkins_home\u76ee\u5f55\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /usr/bin/docker:/usr/bin/docker                # \u8fd9\u662f\u4e3a\u4e86\u6211\u4eec\u53ef\u4ee5\u5728\u5bb9\u5668\u5185\u4f7f\u7528docker\u547d\u4ee4\n      - /usr/local/bin/docker-compose:/usr/local/bin/docker-compose\n"})}),"\n",(0,r.jsx)(e.p,{children:"build:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'BUILD_COIN_OSS_URL\nBUILD_COIN_IMAGE\n\n1. apt install wget && wget ${BUILD_COIN_OSS_URL} -O ${BUILD_COIN_IMAGE}.tar.gz\n2. rm -rf /project && mkdir /project && tar zxvf ${BUILD_COIN_IMAGE}.tar.gz -C /project\n3. cd $(ls -ld /project/* | awk \'{print $NF}\') && docker build . -t ${BUILD_COIN_IMAGE}\n4. curl -X POST -H "Content-Type: application/json" \\\n    -d \'{"msg_type":"text","content":{"text":"\'"${BUILD_COIN_IMAGE} build success."\'"}}\' \\\n  https://open.larksuite.com/open-apis/bot/v2/hook/xxx\n\n\nBUILD_COIN_OSS_URL\nBUILD_COIN_IMAGE\nBUILD_COIN_BIN_PATH\n\n1. apt install wget && wget ${BUILD_COIN_OSS_URL} -O ${BUILD_COIN_IMAGE}.tar.gz\n2. rm -rf /fproject && mkdir /fproject && tar zxvf ${BUILD_COIN_IMAGE}.tar.gz -C /fproject\n3. cd $(ls -ld /fproject/* | awk \'{print $NF}\') && docker build . -t ${BUILD_COIN_IMAGE}\n4. docker run --name jenkins-fork-coin-project -d ${BUILD_COIN_IMAGE} tail -f /dev/null\n5. docker cp jenkins-fork-coin-project:${BUILD_COIN_BIN_PATH} /output/${BUILD_COIN_IMAGE}\n6. docker rm -f jenkins-fork-coin-project\n7. docker save\n8. curl -X POST -H "Content-Type: application/json" \\\n    -d \'{"msg_type":"text","content":{"text":"\'"${BUILD_COIN_IMAGE} build success."\'"}}\' \\\n  https://open.larksuite.com/open-apis/bot/v2/hook/xxx\n'})})]})}function k(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(p,{...n})}):p(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>i});var o=t(96540);const r={},s=o.createContext(r);function c(n){const e=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),o.createElement(s.Provider,{value:e},n.children)}}}]);
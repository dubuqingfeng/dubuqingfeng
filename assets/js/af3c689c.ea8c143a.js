"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[1490],{89389:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>a,frontMatter:()=>o,metadata:()=>s,toc:()=>_});const s=JSON.parse('{"id":"code/blockchain/rpc","title":"rpc","description":"","source":"@site/docs/code/blockchain/rpc.md","sourceDirName":"code/blockchain","slug":"/code/blockchain/rpc","permalink":"/docs/code/blockchain/rpc","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"healthcheck","permalink":"/docs/code/blockchain/healthcheck"},"next":{"title":"mddir","permalink":"/docs/code/dir/mddir"}}');var r=n(74848),i=n(28453);const o={},c=void 0,p={},_=[];function u(e){const t={code:"code",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'\n#!/usr/bin/env python\n# coding=utf-8\nimport requests\nimport json\nimport time\nimport csv\nimport sys\n\nURL = "" # default url\nif len(sys.argv) > 1:\n    URL = sys.argv[1]\n\nrequest_id = 0\nheight = 0\nend_height = 24292064\nstart_height = 24291030\n# sleep_time = 0.2 # \u6682\u505c\u4e00\u6bb5\u65f6\u95f4\nreport = []\nsession = requests.Session()\n\ndef create_request_object(_method, _params, _requestId):\n    return {"jsonrpc":"2.0", "method":_method, "params":_params, "id":_requestId}, _requestId+1\n\ndef post_request_object(_HTTPEnpoint, _jsonRPCRequestObject):\n    response = session.post(_HTTPEnpoint,\n                            json=_jsonRPCRequestObject,\n                            headers={\'Content-type\': \'application/json\'})\n    return response.json()\n\nheight = start_height\n\nwhile True:\n    if height <= end_height:\n        start_time1 = time.time()\n        request_object, requestId = create_request_object(\'eth_getBlockByNumber\', [hex(height), False], request_id)\n        response_object = post_request_object(URL, request_object)\n        result = response_object[\'result\']\n        end_time1 = time.time()\n        spent_time1 = (end_time1 - start_time1)*1000\n        print(\'\u8fd0\u884c\u65f6\u95f4:%.2f\u6beb\u79d2, \u9ad8\u5ea6:%d, \u5f53\u524d\u8fd0\u884c\u65f6\u95f4:%s\' % (spent_time1, height, end_time1))\n        if result==None:\n            report.append([height, end_time1, spent_time1])\n        height = height + 1\n        # time.sleep(sleep_time)\n    else:\n        break\nprint("\u5b8c\u6210, \u5f00\u59cb\u5199\u5165 csv \u6587\u4ef6")\nwith open("output.csv","w") as csvfile:\n    writer = csv.writer(csvfile)\n    writer.writerow(["height","current_time","spent_time"])\n    writer.writerows(report)\n\n'})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'#!/usr/bin/env python\n# coding=utf-8\nimport requests\nimport json\nimport time\nimport csv\nimport sys\n\nURL = "" # default url\nif len(sys.argv) > 1:\n    URL = sys.argv[1]\n\nrequest_id = 0\nheight = 0\nsleep_time = 0.2 # \u6682\u505c\u4e00\u6bb5\u65f6\u95f4\ntotal_time = 300 # \u603b\u5171 5 \u5206\u949f\nis_increasing_print = True # \u53ea\u8bb0\u5f55\u589e\u957f\u533a\u5757\nreport = []\nsession = requests.Session()\n\ndef create_request_object(_method, _params, _requestId):\n    return {"jsonrpc":"2.0", "method":_method, "params":_params, "id":_requestId}, _requestId+1\n\ndef post_request_object(_HTTPEnpoint, _jsonRPCRequestObject):\n    response = session.post(_HTTPEnpoint,\n                            json=_jsonRPCRequestObject,\n                            headers={\'Content-type\': \'application/json\'})\n    return response.json()\n\nstart_time = time.time()\nrequest_object, requestId = create_request_object(\'eth_blockNumber\', [], request_id)\nresponse_object = post_request_object(URL, request_object)\nheight = int(response_object[\'result\'], 16)\nt = time.time()\nspent_time = (t - start_time)*1000\nprint(\'\u8fd0\u884c\u65f6\u95f4:%s\u6beb\u79d2, \u9ad8\u5ea6:%d, \u5f53\u524d\u8fd0\u884c\u65f6\u95f4:%s\' % (spent_time, height, t))\nreport.append([height, t, spent_time])\n\nwhile True:\n    if time.time() - t < total_time:\n        last_height = height\n        start_time1 = time.time()\n        request_object, requestId = create_request_object(\'eth_blockNumber\', [], request_id)\n        response_object = post_request_object(URL, request_object)\n        height = int(response_object[\'result\'], 16)\n        end_time1 = time.time()\n        spent_time1 = (end_time1 - start_time1)*1000\n        if is_increasing_print:\n            if height > last_height:\n                print(\'\u8fd0\u884c\u65f6\u95f4:%.2f\u6beb\u79d2, \u9ad8\u5ea6:%d, \u5f53\u524d\u8fd0\u884c\u65f6\u95f4:%s\' % (spent_time1, height, end_time1))\n                report.append([height, end_time1, spent_time1])\n        else:\n            print(\'\u8fd0\u884c\u65f6\u95f4:%.2f\u6beb\u79d2, \u9ad8\u5ea6:%d, \u5f53\u524d\u8fd0\u884c\u65f6\u95f4:%s\' % (spent_time1, height, end_time1))\n            report.append([height, end_time1, spent_time1])\n        time.sleep(sleep_time)\n    else:\n        print("break")\n        break\nprint("\u5b8c\u6210, \u5f00\u59cb\u5199\u5165 csv \u6587\u4ef6")\nwith open("output.csv","w") as csvfile:\n    writer = csv.writer(csvfile)\n    writer.writerow(["height","current_time","spent_time"])\n    writer.writerows(report)\n'})})]})}function a(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>c});var s=n(96540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);
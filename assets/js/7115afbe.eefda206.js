"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[227],{87607:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>a,frontMatter:()=>s,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"Wiki/blockchain/bitcoin/network/p2p","title":"p2p","description":"P2P \u534f\u8bae\u4e0e\u6d88\u606f","source":"@site/docs/Wiki/blockchain/bitcoin/network/p2p.md","sourceDirName":"Wiki/blockchain/bitcoin/network","slug":"/Wiki/blockchain/bitcoin/network/p2p","permalink":"/docs/Wiki/blockchain/bitcoin/network/p2p","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"min-validator","permalink":"/docs/Wiki/blockchain/bitcoin/impl/min-validator"},"next":{"title":"mempool","permalink":"/docs/Wiki/blockchain/bitcoin/policy/mempool"}}');var l=i(74848),o=i(28453);const s={},t=void 0,r={},d=[{value:"P2P \u534f\u8bae\u4e0e\u6d88\u606f",id:"p2p-\u534f\u8bae\u4e0e\u6d88\u606f",level:2},{value:"\u63e1\u624b\u4e0e\u80fd\u529b",id:"\u63e1\u624b\u4e0e\u80fd\u529b",level:3},{value:"\u540c\u6b65\u4e0e\u4e2d\u7ee7",id:"\u540c\u6b65\u4e0e\u4e2d\u7ee7",level:3},{value:"\u63d0\u5347\u6548\u7387",id:"\u63d0\u5347\u6548\u7387",level:3},{value:"\u6297\u653b\u51fb\u7b56\u7565",id:"\u6297\u653b\u51fb\u7b56\u7565",level:3}];function h(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"p2p-\u534f\u8bae\u4e0e\u6d88\u606f",children:"P2P \u534f\u8bae\u4e0e\u6d88\u606f"}),"\n",(0,l.jsxs)(n.p,{children:["Bitcoin P2P \u4f7f\u7528 TCP\uff0c\u6d88\u606f\u5c01\u88c5\u4e3a\uff1a",(0,l.jsx)(n.code,{children:"magic | command[12] | length | checksum | payload"}),"\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u63e1\u624b\u4e0e\u80fd\u529b",children:"\u63e1\u624b\u4e0e\u80fd\u529b"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"version"}),"/",(0,l.jsx)(n.code,{children:"verack"}),"\uff1a\u4ea4\u6362\u7248\u672c\u3001\u670d\u52a1\u4f4d\uff08NODE_NETWORK \u7b49\uff09\u3001\u7f51\u7edc\u5730\u5740\uff08BIP155 \u652f\u6301 v2/tor v3\uff09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sendheaders"}),"\uff1a\u8bf7\u6c42\u4ee5 ",(0,l.jsx)(n.code,{children:"headers"})," \u800c\u975e ",(0,l.jsx)(n.code,{children:"inv"})," \u65b9\u5f0f\u901a\u544a\u65b0\u533a\u5757"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sendcmpct"}),"\uff1a\u534f\u5546\u7d27\u51d1\u533a\u5757\uff08BIP152\uff09"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u540c\u6b65\u4e0e\u4e2d\u7ee7",children:"\u540c\u6b65\u4e0e\u4e2d\u7ee7"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5934\u540c\u6b65\uff1a",(0,l.jsx)(n.code,{children:"getheaders/headers"}),"\uff0cheaders-first \u518d\u62c9\u533a\u5757"]}),"\n",(0,l.jsxs)(n.li,{children:["\u533a\u5757/\u4ea4\u6613\u4e2d\u7ee7\uff1a",(0,l.jsx)(n.code,{children:"inv -> getdata -> tx/block"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u4fdd\u6d3b\u4e0e\u5ef6\u8fdf\uff1a",(0,l.jsx)(n.code,{children:"ping/pong"})]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u63d0\u5347\u6548\u7387",children:"\u63d0\u5347\u6548\u7387"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7d27\u51d1\u533a\u5757\uff08BIP152\uff09\uff1a\u77ed ID + \u7f3a\u5931\u4ea4\u6613\u6309\u9700\u62c9\u53d6"}),"\n",(0,l.jsx)(n.li,{children:"wtxid \u4e2d\u7ee7\uff08BIP339\uff09\uff1a\u4ee5 wtxid \u4e3a\u5355\u4f4d\uff0c\u914d\u5408\u89c1\u8bc1\u7b56\u7565\u66f4\u7a33\u5b9a"}),"\n",(0,l.jsx)(n.li,{children:"\u8f7b\u5ba2\u6237\u7aef\u8fc7\u6ee4\u5668\uff08BIP157/158, Neutrino\uff09\uff1a\u4ee5 Golomb-Rice \u8fc7\u6ee4\u5668\u66ff\u4ee3 Bloom"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6297\u653b\u51fb\u7b56\u7565",children:"\u6297\u653b\u51fb\u7b56\u7565"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4e2d\u7ee7\u7b56\u7565\u9650\u5236\u975e\u6807\u51c6\u4ea4\u6613\uff0c\u9650\u5236\u811a\u672c\u590d\u6742\u5ea6\u4e0e mempool \u8d44\u6e90"}),"\n",(0,l.jsx)(n.li,{children:"\u5b64\u513f\u6c60\u5927\u5c0f\u9650\u5236\u4e0e\u4f18\u5148\u7ea7\u5904\u7406\uff0c\u9632\u6b62 DoS"}),"\n",(0,l.jsx)(n.li,{children:"\u5730\u5740\u7ba1\u7406\u4e0e\u591a\u51fa\u7ad9\u8fde\u63a5\uff0c\u964d\u4f4e\u5973\u5deb/\u65e5\u8680\u653b\u51fb\u98ce\u9669"}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var c=i(96540);const l={},o=c.createContext(l);function s(e){const n=c.useContext(o);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),c.createElement(o.Provider,{value:n},e.children)}}}]);
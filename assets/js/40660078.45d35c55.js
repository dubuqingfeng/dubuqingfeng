"use strict";(globalThis.webpackChunkdubuqingfeng=globalThis.webpackChunkdubuqingfeng||[]).push([[47682],{28453:(o,e,n)=>{n.d(e,{R:()=>a,x:()=>c});var i=n(96540);const s={},t=i.createContext(s);function a(o){const e=i.useContext(t);return i.useMemo(function(){return"function"==typeof o?o(e):{...e,...o}},[e,o])}function c(o){let e;return e=o.disableParentContext?"function"==typeof o.components?o.components(s):o.components||s:a(o.components),i.createElement(t.Provider,{value:e},o.children)}},87332:(o,e,n)=>{n.r(e),n.d(e,{assets:()=>r,contentTitle:()=>c,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"Wiki/programming/cpp/network/asio","title":"asio","description":"Boost.Asio / Asio \u57fa\u7840","source":"@site/docs/Wiki/programming/cpp/network/asio.md","sourceDirName":"Wiki/programming/cpp/network","slug":"/Wiki/programming/cpp/network/asio","permalink":"/docs/Wiki/programming/cpp/network/asio","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"smart-pointer","permalink":"/docs/Wiki/programming/cpp/memory/smart-pointer"},"next":{"title":"io-models","permalink":"/docs/Wiki/programming/cpp/network/io-models"}}');var s=n(74848),t=n(28453);const a={},c=void 0,r={},p=[{value:"Boost.Asio / Asio \u57fa\u7840",id:"boostasio--asio-\u57fa\u7840",level:3}];function l(o){const e={code:"code",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...o.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h3,{id:"boostasio--asio-\u57fa\u7840",children:"Boost.Asio / Asio \u57fa\u7840"}),"\n",(0,s.jsxs)(e.p,{children:["Asio \u63d0\u4f9b\u8de8\u5e73\u53f0\u5f02\u6b65 IO\uff0c\u652f\u6301\u56de\u8c03\u3001",(0,s.jsx)(e.code,{children:"co_await"}),"\uff08C++20\uff09\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"TCP \u5ba2\u6237\u7aef\uff08\u56de\u8c03\u7248\uff09\u793a\u4f8b\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:'#include <boost/asio.hpp>\n#include <iostream>\n\nint main(){\n  namespace asio = boost::asio;\n  asio::io_context io;\n  asio::ip::tcp::resolver res(io);\n  auto endpoints = res.resolve("example.com", "80");\n  asio::ip::tcp::socket sock(io);\n  asio::async_connect(sock, endpoints,\n    [&](auto ec, auto){ if (!ec) std::cout << "connected\\n"; });\n  io.run();\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u534f\u7a0b\u7248\uff08C++20\uff09\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:'// \u9700\u8981\u7f16\u8bd1\u5668/\u5e93\u652f\u6301\u534f\u7a0b\u4e0e asio::awaitable\nasio::awaitable<void> run(){\n  using namespace boost::asio;\n  ip::tcp::resolver res(co_await this_coro::executor);\n  auto eps = co_await res.async_resolve("example.com","80", use_awaitable);\n  ip::tcp::socket sock(co_await this_coro::executor);\n  co_await async_connect(sock, eps, use_awaitable);\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u8981\u70b9\uff1a\u5408\u7406\u9009\u62e9\u6267\u884c\u5668/\u7ebf\u7a0b\u6c60\uff0c\u5229\u7528 ",(0,s.jsx)(e.code,{children:"strand"})," \u7ebf\u6027\u5316\u540c\u4e00\u5bf9\u8c61\u4e0a\u7684\u56de\u8c03\uff0c\u907f\u514d\u7ade\u6001\u3002"]})]})}function d(o={}){const{wrapper:e}={...(0,t.R)(),...o.components};return e?(0,s.jsx)(e,{...o,children:(0,s.jsx)(l,{...o})}):l(o)}}}]);
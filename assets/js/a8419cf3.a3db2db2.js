"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[8392],{49185:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Wiki/programming/cpp/concurrency/shared-mutex","title":"shared-mutex","description":"\u8bfb\u5199\u9501 std::shared_mutex","source":"@site/docs/Wiki/programming/cpp/concurrency/shared-mutex.md","sourceDirName":"Wiki/programming/cpp/concurrency","slug":"/Wiki/programming/cpp/concurrency/shared-mutex","permalink":"/docs/Wiki/programming/cpp/concurrency/shared-mutex","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"mutex","permalink":"/docs/Wiki/programming/cpp/concurrency/mutex"},"next":{"title":"thread-pool","permalink":"/docs/Wiki/programming/cpp/concurrency/thread-pool"}}');var c=r(74848),i=r(28453);const o={},s=void 0,a={},d=[{value:"\u8bfb\u5199\u9501 std::shared_mutex",id:"\u8bfb\u5199\u9501-stdshared_mutex",level:3}];function u(e){const n={code:"code",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h3,{id:"\u8bfb\u5199\u9501-stdshared_mutex",children:"\u8bfb\u5199\u9501 std::shared_mutex"}),"\n",(0,c.jsx)(n.p,{children:"\u5141\u8bb8\u591a\u4e2a\u8bfb\u8005\u5171\u4eab\u9501\uff0c\u5199\u8005\u72ec\u5360\uff08C++17\uff09\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cpp",children:"#include <shared_mutex>\n#include <thread>\n#include <vector>\n\nint data = 0;\nstd::shared_mutex rw;\n\nvoid reader() {\n  std::shared_lock<std::shared_mutex> lk(rw);\n  (void)data; // \u8bfb\n}\n\nvoid writer() {\n  std::unique_lock<std::shared_mutex> lk(rw);\n  ++data; // \u5199\n}\n\nint main() {\n  std::vector<std::thread> v;\n  for (int i=0;i<4;++i) v.emplace_back(reader);\n  v.emplace_back(writer);\n  for (auto &t: v) t.join();\n}\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8bfb\u591a\u5199\u5c11\u573a\u666f\u53ef\u83b7\u76ca\uff1b\u907f\u514d\u5199\u8005\u9965\u997f\uff0c\u5fc5\u8981\u65f6\u91c7\u7528\u7b56\u7565\u63a7\u5236\u6216\u9009\u62e9\u5176\u4ed6\u540c\u6b65\u539f\u8bed\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(u,{...e})}):u(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>s});var t=r(96540);const c={},i=t.createContext(c);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[8492],{88279:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>c,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"Wiki/programming/nodejs/performance/memory-gc","title":"memory-gc","description":"V8 \u5185\u5b58\u4e0e GC\uff08Node \u89c6\u89d2\uff09","source":"@site/docs/Wiki/programming/nodejs/performance/memory-gc.md","sourceDirName":"Wiki/programming/nodejs/performance","slug":"/Wiki/programming/nodejs/performance/memory-gc","permalink":"/docs/Wiki/programming/nodejs/performance/memory-gc","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"observability","permalink":"/docs/Wiki/programming/nodejs/ops/observability"},"next":{"title":"profiling","permalink":"/docs/Wiki/programming/nodejs/performance/profiling"}}');var s=r(74848),o=r(28453);const c={},l=void 0,d={},t=[{value:"V8 \u5185\u5b58\u4e0e GC\uff08Node \u89c6\u89d2\uff09",id:"v8-\u5185\u5b58\u4e0e-gcnode-\u89c6\u89d2",level:3},{value:"\u8981\u70b9",id:"\u8981\u70b9",level:4},{value:"\u793a\u4f8b\uff1a\u6a21\u62df\u5185\u5b58\u6cc4\u6f0f\u4e0e\u5b9a\u4f4d",id:"\u793a\u4f8b\u6a21\u62df\u5185\u5b58\u6cc4\u6f0f\u4e0e\u5b9a\u4f4d",level:4},{value:"\u5e38\u7528\u53c2\u6570",id:"\u5e38\u7528\u53c2\u6570",level:4}];function a(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"v8-\u5185\u5b58\u4e0e-gcnode-\u89c6\u89d2",children:"V8 \u5185\u5b58\u4e0e GC\uff08Node \u89c6\u89d2\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u7406\u89e3\u65b0\u751f\u4ee3/\u8001\u751f\u4ee3\u4e0e\u5199\u5c4f\u969c\u3001\u8c03\u53c2\u4e0e\u6cc4\u6f0f\u6392\u67e5\uff1b\u670d\u52a1\u7aef\u573a\u666f\u9700\u7ed3\u5408\u957f\u671f\u8fd0\u884c\u4e0e\u8d1f\u8f7d\u7279\u6027\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u8981\u70b9",children:"\u8981\u70b9"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u65b0\u751f\u4ee3/\u8001\u751f\u4ee3\u5927\u5c0f\u4e0e ",(0,s.jsx)(n.code,{children:"--max-old-space-size"}),"\uff1b"]}),"\n",(0,s.jsx)(n.li,{children:"\u9690\u85cf\u7c7b/IC \u5bf9\u6027\u80fd\u5f71\u54cd\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u5e38\u89c1\u6cc4\u6f0f\u6e90\uff1a\u5168\u5c40\u5f15\u7528\u3001\u7f13\u5b58\u672a\u6e05\u7406\u3001\u4e8b\u4ef6\u76d1\u542c\u672a\u79fb\u9664\uff1b"}),"\n",(0,s.jsxs)(n.li,{children:["\u53c2\u8003\uff1aJavaScript \u7ae0\u8282\u7684",(0,s.jsx)(n.a,{href:"/docs/Wiki/programming/javascript/memory/gc",children:"V8 \u5185\u5b58\u4e0e\u5783\u573e\u56de\u6536"}),"\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u793a\u4f8b\u6a21\u62df\u5185\u5b58\u6cc4\u6f0f\u4e0e\u5b9a\u4f4d",children:"\u793a\u4f8b\uff1a\u6a21\u62df\u5185\u5b58\u6cc4\u6f0f\u4e0e\u5b9a\u4f4d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// \u614e\u7528\uff1a\u6f14\u793a\u6cc4\u6f0f\nconst leaks = [];\nsetInterval(() => leaks.push(Buffer.alloc(1e6)), 100); // \u6bcf 100ms \u589e\u957f 1MB\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6392\u67e5\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u8fd0\u884c ",(0,s.jsx)(n.code,{children:"node --inspect --expose-gc app.js"}),"\uff0c\u5728 DevTools \u91c7\u96c6\u591a\u4efd\u5806\u5feb\u7167\u5bf9\u6bd4\uff1b"]}),"\n",(0,s.jsx)(n.li,{children:"\u76d1\u63a7 Full GC \u6b21\u6570/\u8017\u65f6\u4e0e\u4e8b\u4ef6\u5faa\u73af\u5ef6\u8fdf\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u7ed3\u5408\u5bf9\u8c61\u4fdd\u7559\u8def\u5f84\uff08Retainers\uff09\u627e\u5230\u5168\u5c40\u5f15\u7528\u6216\u7f13\u5b58\u672a\u6e05\u7406\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5e38\u7528\u53c2\u6570",children:"\u5e38\u7528\u53c2\u6570"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--max-old-space-size=4096"})," \u8c03\u6574\u8001\u751f\u4ee3\u4e0a\u9650\uff1b"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--trace-gc --trace-gc-verbose"})," \u89c2\u5bdf GC \u884c\u4e3a\uff08\u751f\u4ea7\u614e\u7528\uff09\uff1b"]}),"\n",(0,s.jsx)(n.li,{children:"\u907f\u514d\u5927\u5bf9\u8c61\u957f\u65f6\u95f4\u5b58\u6d3b\uff0c\u6279\u91cf\u91ca\u653e\u53ef\u964d\u4f4e\u664b\u5347\u538b\u529b\u3002"}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>l});var i=r(96540);const s={},o=i.createContext(s);function c(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);
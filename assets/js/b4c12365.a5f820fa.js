"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[4255],{40480:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"Wiki/programming/database/mysql/replication-ha","title":"\u590d\u5236\u3001GTID \u4e0e\u9ad8\u53ef\u7528","description":"\u6982\u89c8 MySQL \u590d\u5236\u3001GTID\u3001\u534a\u540c\u6b65\u4e0e MGR/InnoDB Cluster \u57fa\u672c\u77e5\u8bc6\u4e0e\u5b9e\u8df5\u8981\u70b9\u3002","source":"@site/docs/Wiki/programming/database/mysql/replication-ha.md","sourceDirName":"Wiki/programming/database/mysql","slug":"/Wiki/programming/database/mysql/replication-ha","permalink":"/docs/Wiki/programming/database/mysql/replication-ha","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u590d\u5236\u3001GTID \u4e0e\u9ad8\u53ef\u7528"},"sidebar":"tutorialSidebar","previous":{"title":"Optimizer Trace \u4e0e\u6267\u884c\u8ba1\u5212\u8bca\u65ad","permalink":"/docs/Wiki/programming/database/mysql/optimizer-trace"},"next":{"title":"\u4e8b\u52a1\u4e0e\u9694\u79bb\uff08\u542b MVCC\uff09","permalink":"/docs/Wiki/programming/database/mysql/transaction-isolation"}}');var r=i(74848),s=i(28453);const c={title:"\u590d\u5236\u3001GTID \u4e0e\u9ad8\u53ef\u7528"},o=void 0,t={},d=[{value:"Binlog \u4e0e\u683c\u5f0f",id:"binlog-\u4e0e\u683c\u5f0f",level:2},{value:"\u57fa\u7840\u590d\u5236",id:"\u57fa\u7840\u590d\u5236",level:2},{value:"\u534a\u540c\u6b65\u590d\u5236",id:"\u534a\u540c\u6b65\u590d\u5236",level:2},{value:"Group Replication / InnoDB Cluster",id:"group-replication--innodb-cluster",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u6392\u67e5\u547d\u4ee4",id:"\u6392\u67e5\u547d\u4ee4",level:2}];function a(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\u6982\u89c8 MySQL \u590d\u5236\u3001GTID\u3001\u534a\u540c\u6b65\u4e0e MGR/InnoDB Cluster \u57fa\u672c\u77e5\u8bc6\u4e0e\u5b9e\u8df5\u8981\u70b9\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"binlog-\u4e0e\u683c\u5f0f",children:"Binlog \u4e0e\u683c\u5f0f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Binlog \u683c\u5f0f\uff1a",(0,r.jsx)(n.code,{children:"ROW"}),"\uff08\u63a8\u8350\uff09\u3001",(0,r.jsx)(n.code,{children:"STATEMENT"}),"\u3001",(0,r.jsx)(n.code,{children:"MIXED"}),"\uff1bROW \u7cbe\u786e\u4f46\u4f53\u79ef\u8f83\u5927\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5173\u952e\u53c2\u6570\uff1a",(0,r.jsx)(n.code,{children:"server_id"}),"\u3001",(0,r.jsx)(n.code,{children:"binlog_format"}),"\u3001",(0,r.jsx)(n.code,{children:"log_bin"}),"\u3001",(0,r.jsx)(n.code,{children:"gtid_mode"}),"\u3001",(0,r.jsx)(n.code,{children:"enforce_gtid_consistency"}),"\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u57fa\u7840\u590d\u5236",children:"\u57fa\u7840\u590d\u5236"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4f20\u7edf\u57fa\u4e8e\u5750\u6807\uff1a",(0,r.jsx)(n.code,{children:"CHANGE MASTER TO MASTER_LOG_FILE=..., MASTER_LOG_POS=...;"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u57fa\u4e8e GTID\uff1a",(0,r.jsx)(n.code,{children:"CHANGE MASTER TO MASTER_AUTO_POSITION=1;"})," \u66f4\u6613\u5207\u6362\u4e0e\u5bb9\u707e\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u76d1\u63a7\u5ef6\u8fdf\uff1a",(0,r.jsx)(n.code,{children:"Seconds_Behind_Master"}),"\uff088.0 \u540e\u4e3a ",(0,r.jsx)(n.code,{children:"Replica"})," \u672f\u8bed\uff09\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u534a\u540c\u6b65\u590d\u5236",children:"\u534a\u540c\u6b65\u590d\u5236"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e3b\u5e93\u63d0\u4ea4\u9700\u7b49\u5f85\u81f3\u5c11\u4e00\u53f0\u4ece\u5e93\u786e\u8ba4\u5199\u5165 RelayLog\uff1b\u964d\u4f4e\u6570\u636e\u4e22\u5931\u98ce\u9669\uff0c\u589e\u52a0\u5ef6\u8fdf\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"group-replication--innodb-cluster",children:"Group Replication / InnoDB Cluster"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5f3a\u4e00\u81f4\u590d\u5236\u7ec4\uff08Paxos/Raft \u7c7b\uff09\uff0c\u51b2\u7a81\u68c0\u6d4b\u4e0e\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u8bfb\u5199\u5206\u79bb\u3001\u9ad8\u53ef\u7528\u62d3\u6251\uff0c\u914d\u5408 Router \u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u590d\u5236\u5ef6\u8fdf\uff1a\u5927\u4e8b\u52a1\u3001IO/CPU \u74f6\u9888\uff1b\u62c6\u5c0f\u4e8b\u52a1\u3001\u63d0\u5347\u786c\u4ef6\u3001\u8c03\u53c2\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u4e3b\u4ece\u4e0d\u4e00\u81f4\uff1a\u8fc7\u6ee4\u89c4\u5219\u9519\u8bef\u3001\u975e\u786e\u5b9a\u6027\u51fd\u6570\uff1b\u4f18\u5148 ROW \u5e76\u89c4\u907f\u4e0d\u786e\u5b9a\u6027\u5199\u6cd5\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["\u5d29\u6e83\u6062\u590d\u4e0e Crash-Safe \u590d\u5236\uff1a",(0,r.jsx)(n.code,{children:"relay_log_recovery=ON"}),"\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u6392\u67e5\u547d\u4ee4",children:"\u6392\u67e5\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SHOW MASTER STATUS;   -- \u4e3b\u5e93\u4f4d\u70b9/GTID\nSHOW SLAVE STATUS\\G;  -- \u590d\u5236\u72b6\u6001\uff088.0: SHOW REPLICA STATUS\\G\uff09\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var l=i(96540);const r={},s=l.createContext(r);function c(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);
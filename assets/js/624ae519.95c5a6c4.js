"use strict";(globalThis.webpackChunkdubuqingfeng=globalThis.webpackChunkdubuqingfeng||[]).push([[19794],{28453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>c});var t=r(96540);const i={},o=t.createContext(i);function a(n){const e=t.useContext(o);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),t.createElement(o.Provider,{value:e},n.children)}},57645:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>s,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Wiki/programming/python/concurrency/threading","title":"threading","description":"Threading \u7ebf\u7a0b","source":"@site/docs/Wiki/programming/python/concurrency/threading.md","sourceDirName":"Wiki/programming/python/concurrency","slug":"/Wiki/programming/python/concurrency/threading","permalink":"/docs/Wiki/programming/python/concurrency/threading","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"multiprocessing","permalink":"/docs/Wiki/programming/python/concurrency/multiprocessing"},"next":{"title":"dict","permalink":"/docs/Wiki/programming/python/data-structure/dict"}}');var i=r(74848),o=r(28453);const a={},c=void 0,s={},d=[{value:"Threading \u7ebf\u7a0b",id:"threading-\u7ebf\u7a0b",level:3},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:4},{value:"\u540c\u6b65\u539f\u8bed",id:"\u540c\u6b65\u539f\u8bed",level:4},{value:"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005",id:"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005",level:4}];function u(n){const e={code:"code",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h3,{id:"threading-\u7ebf\u7a0b",children:"Threading \u7ebf\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u6982\u5ff5\u8981\u70b9\uff1aGIL\u3001I/O \u5bc6\u96c6\u578b\u9002\u7528\u3001\u9501/\u6761\u4ef6/\u961f\u5217\u3001\u7ebf\u7a0b\u6c60\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-py",children:"import threading\n\ndef work(n):\n    print('hello', n)\n\nt = threading.Thread(target=work, args=(1,))\nt.start(); t.join()\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-py",children:"from concurrent.futures import ThreadPoolExecutor\n\nwith ThreadPoolExecutor(max_workers=8) as ex:\n    futs = [ex.submit(work, i) for i in range(10)]\n    for f in futs:\n        f.result()\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u540c\u6b65\u539f\u8bed",children:"\u540c\u6b65\u539f\u8bed"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-py",children:"from threading import Lock, RLock, Event, Condition, Semaphore\n\nlock = Lock(); evt = Event(); sem = Semaphore(3)\n\nwith lock:\n    # \u4e34\u754c\u533a\n    pass\n\nevt.set(); evt.wait()\n\ncond = Condition()\nwith cond:\n    cond.notify_all()\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005",children:"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-py",children:"import threading, queue\n\nq = queue.Queue(maxsize=100)\n\ndef producer():\n    for i in range(1000):\n        q.put(i)\n    q.put(None)  # \u7ed3\u675f\u6807\u8bb0\n\ndef consumer():\n    while True:\n        x = q.get()\n        if x is None: break\n        # process x\n        q.task_done()\n\nthreading.Thread(target=producer).start()\nthreading.Thread(target=consumer).start()\n"})})]})}function l(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(u,{...n})}):u(n)}}}]);
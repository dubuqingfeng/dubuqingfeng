"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[2618],{78460:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"Wiki/programming/python/memory/gc","title":"gc","description":"Python \u5783\u573e\u56de\u6536\u4e0e\u5185\u5b58\u7ba1\u7406","source":"@site/docs/Wiki/programming/python/memory/gc.md","sourceDirName":"Wiki/programming/python/memory","slug":"/Wiki/programming/python/memory/gc","permalink":"/docs/Wiki/programming/python/memory/gc","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"interview","permalink":"/docs/Wiki/programming/python/interview/"},"next":{"title":"pip","permalink":"/docs/Wiki/programming/python/toolchain/pip"}}');var o=r(74848),i=r(28453);const c={},s=void 0,l={},a=[{value:"Python \u5783\u573e\u56de\u6536\u4e0e\u5185\u5b58\u7ba1\u7406",id:"python-\u5783\u573e\u56de\u6536\u4e0e\u5185\u5b58\u7ba1\u7406",level:3},{value:"<code>gc</code> \u6a21\u5757\u4e0e\u8c03\u8bd5",id:"gc-\u6a21\u5757\u4e0e\u8c03\u8bd5",level:4},{value:"\u5f15\u7528\u73af\u4e0e\u5f31\u5f15\u7528",id:"\u5f15\u7528\u73af\u4e0e\u5f31\u5f15\u7528",level:4},{value:"\u6cc4\u6f0f\u4e0e\u5927\u5bf9\u8c61\u6392\u67e5",id:"\u6cc4\u6f0f\u4e0e\u5927\u5bf9\u8c61\u6392\u67e5",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h3,{id:"python-\u5783\u573e\u56de\u6536\u4e0e\u5185\u5b58\u7ba1\u7406",children:"Python \u5783\u573e\u56de\u6536\u4e0e\u5185\u5b58\u7ba1\u7406"}),"\n",(0,o.jsxs)(n.p,{children:["\u6838\u5fc3\u673a\u5236\uff1a\u5f15\u7528\u8ba1\u6570 + \u5faa\u73af\u68c0\u6d4b\u5206\u4ee3 GC\uff1b\u5bf9\u8c61\u6c60/\u5c0f\u6574\u6570\u7f13\u5b58\uff1b",(0,o.jsx)(n.code,{children:"__del__"})," \u4e0e\u5f31\u5f15\u7528\u3002"]}),"\n",(0,o.jsxs)(n.h4,{id:"gc-\u6a21\u5757\u4e0e\u8c03\u8bd5",children:[(0,o.jsx)(n.code,{children:"gc"})," \u6a21\u5757\u4e0e\u8c03\u8bd5"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-py",children:"import gc\ngc.get_threshold()         # \u5206\u4ee3\u9608\u503c\ngc.set_threshold(700,10,10)\ngc.disable(); gc.collect(); gc.enable()\ngc.set_debug(gc.DEBUG_UNCOLLECTABLE)\n"})}),"\n",(0,o.jsx)(n.h4,{id:"\u5f15\u7528\u73af\u4e0e\u5f31\u5f15\u7528",children:"\u5f15\u7528\u73af\u4e0e\u5f31\u5f15\u7528"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-py",children:"import weakref\n\nclass Node: pass\na = Node(); b = Node()\na.other = b; b.other = a  # \u5f15\u7528\u73af\n\nobj = Node()\nw = weakref.ref(obj)\ndel obj; assert w() is None\n"})}),"\n",(0,o.jsx)(n.h4,{id:"\u6cc4\u6f0f\u4e0e\u5927\u5bf9\u8c61\u6392\u67e5",children:"\u6cc4\u6f0f\u4e0e\u5927\u5bf9\u8c61\u6392\u67e5"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"tracemalloc"})," \u8ddf\u8e2a\u5206\u914d\u6e90\u5934\uff1a"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-py",children:"import tracemalloc\ntracemalloc.start()\n# ... \u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\nsnap = tracemalloc.take_snapshot(); print(snap.statistics('filename')[:5])\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u5173\u6ce8\u957f\u751f\u547d\u5468\u671f\u5168\u5c40\u5bb9\u5668\u3001\u7f13\u5b58\u3001\u4e8b\u4ef6\u56de\u8c03\u672a\u89e3\u7ed1\uff1b"}),"\n",(0,o.jsx)(n.li,{children:"\u79d1\u5b66\u8ba1\u7b97\u907f\u514d\u65e0\u754c\u589e\u957f\u7684\u4e2d\u95f4 ndarray/tensor\u3002"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>s});var t=r(96540);const o={},i=t.createContext(o);function c(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
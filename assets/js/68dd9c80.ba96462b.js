"use strict";(globalThis.webpackChunkdubuqingfeng=globalThis.webpackChunkdubuqingfeng||[]).push([[9365],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var r=t(96540);const a={},i=r.createContext(a);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:n},e.children)}},61028:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"Wiki/programming/dart/async","title":"Future/Stream/async-await","description":"Dart \u7684\u5f02\u6b65\u57fa\u4e8e Future\uff08\u4e00\u6b21\u6027\uff09\u4e0e Stream\uff08\u591a\u6b21\uff09\u3002","source":"@site/docs/Wiki/programming/dart/async.md","sourceDirName":"Wiki/programming/dart","slug":"/Wiki/programming/dart/async","permalink":"/docs/Wiki/programming/dart/async","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Future/Stream/async-await"},"sidebar":"tutorialSidebar","previous":{"title":"Dart","permalink":"/docs/wiki/programming/dart"},"next":{"title":"\u8bed\u6cd5/\u7c7b\u578b/\u7a7a\u5b89\u5168","permalink":"/docs/Wiki/programming/dart/basics"}}');var a=t(74848),i=t(28453);const s={title:"Future/Stream/async-await"},c=void 0,l={},o=[{value:"Future \u4e0e async/await",id:"future-\u4e0e-asyncawait",level:2},{value:"Stream",id:"stream",level:2},{value:"\u9519\u8bef\u5904\u7406\u4e0e\u8d85\u65f6",id:"\u9519\u8bef\u5904\u7406\u4e0e\u8d85\u65f6",level:2},{value:"\u7ec4\u5408\u5e76\u53d1",id:"\u7ec4\u5408\u5e76\u53d1",level:2},{value:"StreamController \u4e0e\u5e7f\u64ad",id:"streamcontroller-\u4e0e\u5e7f\u64ad",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["Dart \u7684\u5f02\u6b65\u57fa\u4e8e ",(0,a.jsx)(n.code,{children:"Future"}),"\uff08\u4e00\u6b21\u6027\uff09\u4e0e ",(0,a.jsx)(n.code,{children:"Stream"}),"\uff08\u591a\u6b21\uff09\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"future-\u4e0e-asyncawait",children:"Future \u4e0e async/await"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"Future<int> fetch() async {\n  await Future.delayed(Duration(milliseconds: 100));\n  return 42;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"stream",children:"Stream"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"Stream<int> gen() async* {\n  for (var i = 0; i < 3; i++) {\n    yield i;\n  }\n}\n\nvoid main() async {\n  await for (final v in gen()) {\n    print(v);\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u9519\u8bef\u5904\u7406\u4e0e\u8d85\u65f6",children:"\u9519\u8bef\u5904\u7406\u4e0e\u8d85\u65f6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final v = await fetch().timeout(const Duration(seconds: 2), onTimeout: () => -1);\ntry {\n  final x = await fetch();\n} catch (e, st) {\n  // \u7edf\u4e00\u8bb0\u5f55\u6216\u91cd\u8bd5\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u7ec4\u5408\u5e76\u53d1",children:"\u7ec4\u5408\u5e76\u53d1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final results = await Future.wait<int>([\n  fetch(),\n  fetch(),\n], eagerError: true);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"streamcontroller-\u4e0e\u5e7f\u64ad",children:"StreamController \u4e0e\u5e7f\u64ad"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final ctrl = StreamController<int>.broadcast();\nfinal sub = ctrl.stream.listen((v) {});\nctrl.add(1);\nawait sub.cancel();\nawait ctrl.close();\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);
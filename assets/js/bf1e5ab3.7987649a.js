"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[2518],{49374:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"Wiki/programming/nodejs/concurrency/worker-threads","title":"worker-threads","description":"Worker Threads","source":"@site/docs/Wiki/programming/nodejs/concurrency/worker-threads.md","sourceDirName":"Wiki/programming/nodejs/concurrency","slug":"/Wiki/programming/nodejs/concurrency/worker-threads","permalink":"/docs/Wiki/programming/nodejs/concurrency/worker-threads","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"libuv-threadpool","permalink":"/docs/Wiki/programming/nodejs/concurrency/libuv-threadpool"},"next":{"title":"pm2-docker","permalink":"/docs/Wiki/programming/nodejs/deploy/pm2-docker"}}');var s=n(74848),t=n(28453);const i={},c=void 0,d={},a=[{value:"Worker Threads",id:"worker-threads",level:3},{value:"\u8981\u70b9",id:"\u8981\u70b9",level:4},{value:"\u793a\u4f8b\uff1a\u57fa\u672c Worker",id:"\u793a\u4f8b\u57fa\u672c-worker",level:4}];function l(e){const r={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h3,{id:"worker-threads",children:"Worker Threads"}),"\n",(0,s.jsx)(r.p,{children:"\u5728\u540c\u4e00\u8fdb\u7a0b\u5185\u63d0\u4f9b\u591a\u7ebf\u7a0b\u6267\u884c\u73af\u5883\uff0c\u9002\u5408 CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u4e0e\u9694\u79bb\u72b6\u6001\u7ba1\u7406\u3002"}),"\n",(0,s.jsx)(r.h4,{id:"\u8981\u70b9",children:"\u8981\u70b9"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\u521b\u5efa\u4e0e\u901a\u4fe1\uff1a",(0,s.jsx)(r.code,{children:"worker_threads"}),"\u3001",(0,s.jsx)(r.code,{children:"MessageChannel/MessagePort"}),"\uff1b"]}),"\n",(0,s.jsxs)(r.li,{children:["\u5171\u4eab\u5185\u5b58\uff1a",(0,s.jsx)(r.code,{children:"SharedArrayBuffer"}),"\u3001",(0,s.jsx)(r.code,{children:"Atomics"}),"\uff1b"]}),"\n",(0,s.jsx)(r.li,{children:"\u8d44\u6e90\u7ba1\u7406\uff1a\u4f20\u8f93 vs \u590d\u5236\u3001\u7ed3\u6784\u5316\u514b\u9686\uff1b"}),"\n",(0,s.jsx)(r.li,{children:"\u4e0e Cluster \u7684\u533a\u522b\uff1a\u7ebf\u7a0b vs \u8fdb\u7a0b\u3001\u5185\u5b58\u4e0e\u5d29\u6e83\u9694\u79bb\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"\u793a\u4f8b\u57fa\u672c-worker",children:"\u793a\u4f8b\uff1a\u57fa\u672c Worker"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"// main.mjs\nimport { Worker } from 'node:worker_threads';\nconst worker = new Worker(new URL('./worker.mjs', import.meta.url), { workerData: { n: 42 } });\nworker.on('message', (msg) => console.log('result:', msg));\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"// worker.mjs\nimport { parentPort, workerData } from 'node:worker_threads';\nparentPort.postMessage(workerData.n * 2);\n"})}),"\n",(0,s.jsx)(r.p,{children:"\u4efb\u52a1\u6c60\u5efa\u8bae\uff1a\u9884\u70ed\u56fa\u5b9a\u6570\u91cf\u7684 Worker\uff0c\u4f7f\u7528\u961f\u5217\u5206\u53d1\u4efb\u52a1\uff0c\u907f\u514d\u9891\u7e41\u521b\u5efa\u9500\u6bc1\u3002"}),"\n",(0,s.jsxs)(r.p,{children:["\u6784\u5efa\u6ce8\u610f\uff1a\u6253\u5305\u5668\u9700\u5c06 Worker \u5165\u53e3\u6807\u8bb0\u4e3a\u72ec\u7acb bundle\uff1bTS \u4e2d\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"new URL('./worker.ts', import.meta.url)"})," \u914d\u5408\u6784\u5efa\u5668\u7684 loader\u3002"]})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>c});var o=n(96540);const s={},t=o.createContext(s);function i(e){const r=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);
"use strict";(self.webpackChunkdubuqingfeng=self.webpackChunkdubuqingfeng||[]).push([[8751],{1560:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"Wiki/programming/java/jvm/gc/overview","title":"overview","description":"GC \u6982\u89c8\u4e0e\u5185\u5b58\u533a\u57df","source":"@site/docs/Wiki/programming/java/jvm/gc/overview.md","sourceDirName":"Wiki/programming/java/jvm/gc","slug":"/Wiki/programming/java/jvm/gc/overview","permalink":"/docs/Wiki/programming/java/jvm/gc/overview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"g1","permalink":"/docs/Wiki/programming/java/jvm/gc/g1"},"next":{"title":"zgc","permalink":"/docs/Wiki/programming/java/jvm/gc/zgc"}}');var s=i(74848),r=i(28453);const c={},o=void 0,d={},t=[{value:"GC \u6982\u89c8\u4e0e\u5185\u5b58\u533a\u57df",id:"gc-\u6982\u89c8\u4e0e\u5185\u5b58\u533a\u57df",level:3},{value:"ToC",id:"toc",level:4},{value:"\u8fd0\u884c\u65f6\u5185\u5b58\u5e03\u5c40\uff08HotSpot\uff09",id:"\u8fd0\u884c\u65f6\u5185\u5b58\u5e03\u5c40hotspot",level:4},{value:"GC Roots \u4e0e Safepoint",id:"gc-roots-\u4e0e-safepoint",level:4},{value:"\u5206\u4ee3\u5047\u8bf4\u4e0e\u5e38\u89c1\u6536\u96c6\u5668",id:"\u5206\u4ee3\u5047\u8bf4\u4e0e\u5e38\u89c1\u6536\u96c6\u5668",level:4},{value:"\u8c03\u4f18\u7ef4\u5ea6\u4e0e\u6307\u6807",id:"\u8c03\u4f18\u7ef4\u5ea6\u4e0e\u6307\u6807",level:4},{value:"\u5e38\u7528\u547d\u4ee4\u4e0e\u65e5\u5fd7",id:"\u5e38\u7528\u547d\u4ee4\u4e0e\u65e5\u5fd7",level:4},{value:"\u5185\u5b58\u4e0e\u76ee\u6807\u8bbe\u5b9a",id:"\u5185\u5b58\u4e0e\u76ee\u6807\u8bbe\u5b9a",level:4}];function a(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"gc-\u6982\u89c8\u4e0e\u5185\u5b58\u533a\u57df",children:"GC \u6982\u89c8\u4e0e\u5185\u5b58\u533a\u57df"}),"\n",(0,s.jsx)(n.h4,{id:"toc",children:"ToC"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8fd0\u884c\u65f6\u5185\u5b58\u5e03\u5c40"}),"\n",(0,s.jsx)(n.li,{children:"GC Roots \u4e0e Safepoint"}),"\n",(0,s.jsx)(n.li,{children:"\u5206\u4ee3\u5047\u8bf4\u4e0e\u5e38\u89c1\u6536\u96c6\u5668"}),"\n",(0,s.jsx)(n.li,{children:"\u8c03\u4f18\u7ef4\u5ea6\u4e0e\u6307\u6807"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8fd0\u884c\u65f6\u5185\u5b58\u5e03\u5c40hotspot",children:"\u8fd0\u884c\u65f6\u5185\u5b58\u5e03\u5c40\uff08HotSpot\uff09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Java Heap\uff08\u65b0\u751f\u4ee3/\u8001\u5e74\u4ee3\uff0cG1 \u7b49\u4e3a Region \u5316\uff09\uff1a\u5bf9\u8c61\u4e3b\u8981\u5206\u914d\u5730\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"Metaspace\uff1a\u7c7b\u5143\u6570\u636e\uff08\u66ff\u4ee3 PermGen\uff09\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"Thread Stack\uff1a\u6bcf\u7ebf\u7a0b\u79c1\u6709\u6808\u5e27\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"Code Cache\uff1aJIT \u751f\u6210\u7684\u673a\u5668\u7801\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u5176\u4ed6\uff1aTLAB\u3001C1/C2 \u7f16\u8bd1\u7f13\u5b58\u7b49\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"gc-roots-\u4e0e-safepoint",children:"GC Roots \u4e0e Safepoint"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"GC Roots\uff1a\u6808\u4e0a\u7684\u5c40\u90e8\u53d8\u91cf\u3001\u9759\u6001\u5b57\u6bb5\u3001JNI \u672c\u5730\u5f15\u7528\u7b49\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"Safepoint\uff1aJVM \u5728\u7279\u5b9a\u5b89\u5168\u70b9\u6302\u8d77/\u68c0\u67e5\u7ebf\u7a0b\u4ee5\u6267\u884c STW \u9636\u6bb5\uff08\u5982\u6839\u53ef\u8fbe\u6027\u626b\u63cf\u3001\u8f6c\u79fb/\u91cd\u5b9a\u4f4d\uff09\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u5199\u5c4f\u969c/\u8bfb\u5c4f\u969c\uff1a\u8f85\u52a9\u5e76\u53d1/\u589e\u91cf\u5f0f\u6536\u96c6\uff08\u5982 SATB/\u5361\u8868\uff09\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5206\u4ee3\u5047\u8bf4\u4e0e\u5e38\u89c1\u6536\u96c6\u5668",children:"\u5206\u4ee3\u5047\u8bf4\u4e0e\u5e38\u89c1\u6536\u96c6\u5668"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u201c\u5927\u591a\u6570\u5bf9\u8c61\u671d\u751f\u5915\u6b7b\uff0c\u5c11\u6570\u5bf9\u8c61\u5b58\u6d3b\u65f6\u95f4\u8f83\u957f\u201d \u2192 \u65b0\u751f\u4ee3\u91c7\u7528\u590d\u5236\u7b97\u6cd5\uff0c\u8001\u5e74\u4ee3\u91c7\u7528\u6807\u8bb0-\u6574\u7406/\u538b\u7f29\uff1b"}),"\n",(0,s.jsxs)(n.li,{children:["\u5178\u578b\u6536\u96c6\u5668\uff1a","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Serial/Parallel\uff1a\u541e\u5410\u4f18\u5148\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"CMS\uff08\u5df2\u5e9f\u5f03\uff09\uff1a\u5e76\u53d1\u6807\u8bb0\u6e05\u9664\uff0c\u788e\u7247\u95ee\u9898\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"G1\uff1aRegion \u5316\u3001\u5e76\u53d1\u6807\u8bb0\u3001\u53ef\u9884\u6d4b\u6682\u505c\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"ZGC/Shenandoah\uff1a\u4f4e\u505c\u987f\u6536\u96c6\u5668\uff08\u8bfb\u5c4f\u969c/\u67d3\u8272\u6307\u9488\uff09\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u8c03\u4f18\u7ef4\u5ea6\u4e0e\u6307\u6807",children:"\u8c03\u4f18\u7ef4\u5ea6\u4e0e\u6307\u6807"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u76ee\u6807\uff1a\u541e\u5410\u7387\u3001\u6700\u5927\u6682\u505c\u65f6\u95f4\u3001\u5c3e\u5ef6\u8fdf\uff1b"}),"\n",(0,s.jsx)(n.li,{children:"\u6307\u6807\uff1a\u5e74\u8f7b\u4ee3/\u8001\u5e74\u4ee3\u5360\u7528\u3001\u664b\u5347\u5931\u8d25\u3001Full GC \u6b21\u6570\u4e0e\u65f6\u957f\u3001\u5bf9\u8c61\u5206\u914d\u901f\u7387\u3001\u5e78\u5b58\u533a\u590d\u5236\u5931\u8d25\uff1b"}),"\n",(0,s.jsxs)(n.li,{children:["\u5de5\u5177\uff1aJFR\u3001",(0,s.jsx)(n.code,{children:"jstat -gcutil"}),"\u3001",(0,s.jsx)(n.code,{children:"jcmd GC.heap_info"}),"\u3001",(0,s.jsx)(n.code,{children:"jmap -histo"}),"\u3001GC \u65e5\u5fd7\uff08",(0,s.jsx)(n.code,{children:"-Xlog:gc*"}),"\uff09\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5e38\u7528\u547d\u4ee4\u4e0e\u65e5\u5fd7",children:"\u5e38\u7528\u547d\u4ee4\u4e0e\u65e5\u5fd7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# \u6982\u89c8\u4e0e\u76d1\u63a7\njcmd <pid> GC.heap_info\njstat -gcutil <pid> 1s 20     # \u6bcf\u79d2\u8f93\u51fa 20 \u6b21 GC \u5229\u7528\u7387\njmap -histo:live <pid> | head # \u6d3b\u5bf9\u8c61\u76f4\u65b9\u56fe\n\n# \u6253\u5f00 GC \u65e5\u5fd7\uff08JDK 9+\uff09\nJAVA_TOOL_OPTIONS="-Xlog:gc*,safepoint:file=gc.log:tags,uptime,level"\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u65e5\u5fd7\u8981\u70b9\uff1a\u5e74\u8f7b\u4ee3/\u6df7\u5408/Full GC \u6b21\u6570\u4e0e\u6682\u505c\u3001\u664b\u5347\u5931\u8d25\uff08promotion failed\uff09\u3001Humongous \u5bf9\u8c61\u3001\u5e76\u53d1\u6807\u8bb0\u65f6\u95f4\u3001\u56de\u6536\u96c6\u5927\u5c0f\u7b49\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u5185\u5b58\u4e0e\u76ee\u6807\u8bbe\u5b9a",children:"\u5185\u5b58\u4e0e\u76ee\u6807\u8bbe\u5b9a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521d\u59cb\u4e0e\u6700\u5927\u5806\uff1a",(0,s.jsx)(n.code,{children:"-Xms"}),"/",(0,s.jsx)(n.code,{children:"-Xmx"}),"\uff0c\u751f\u4ea7\u5efa\u8bae\u8bbe\u7f6e\u4e3a\u76f8\u7b49\u51cf\u5c11\u6269\u5bb9\uff1b"]}),"\n",(0,s.jsx)(n.li,{children:"\u76ee\u6807\u4f18\u5148\u7ea7\uff1a\u541e\u5410\uff08Parallel\uff09vs \u6682\u505c\uff08G1/ZGC\uff09\uff1b"}),"\n",(0,s.jsxs)(n.li,{children:["\u6307\u6807\u95ed\u73af\uff1a\u8bbe\u5b9a ",(0,s.jsx)(n.code,{children:"MaxGCPauseMillis"}),"/SLA \u2192 \u76d1\u63a7 \u2192 \u8c03\u6574 Region/\u9608\u503c/\u8f6f\u4e0a\u9650\uff08\u5982 ZGC \u7684 ",(0,s.jsx)(n.code,{children:"SoftMaxHeapSize"}),"\uff09\u3002"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var l=i(96540);const s={},r=l.createContext(s);function c(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);